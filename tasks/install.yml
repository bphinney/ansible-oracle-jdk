---
- name: Create java directory
  file:
    path: "{{ java.install_dir }}"
    state: directory
    mode: 0755
    owner: root
    group: root

- name: Download JDK tarball
  get_url:
    url: "{{ java.source_url }}/{{ java.archive }}"
    dest: "{{ java.temp_dir }}"
    headers: "Cookie:gpw_e24=http%3A%2F%2Fwww.oracle.com%2F; oraclelicense=accept-securebackup-cookie"

- name: Unpack JDK tarball
  unarchive:
    src: "{{ java.temp_dir }}/{{ java.archive }}"
    dest: "{{ java.install_dir }}"
    remote_src: yes
    owner: root
    group: root
    creates: "{{ java.real_home }}"

- name: Install Alternatives
  alternatives:
    name: java-home-link
    link: "{{ java.home }}"
    path: "{{ java.real_home }}"
    priority: 30

- name: Symlink Java
  file:
    dest: /usr/bin/java
    src: "{{ java.real_home }}/bin/java"
    state: link
    owner: root
    group: root

- name: Set default JAVA_HOME
  template: >
    src=java.sh.j2
    dest=/etc/profile.d/java.sh
    mode=644
    owner=root
    group=root
